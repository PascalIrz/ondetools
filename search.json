[{"path":"https://pascalirz.github.io/ondetools/articles/vignette_ondetools.html","id":"pourquoi-ce-package","dir":"Articles","previous_headings":"","what":"Pourquoi ce package ?","title":"Documentation du package ondetools","text":"Le package ondetools vise à faciliter le chargement et l’exploitation des données de l’observatoire national des étiages - ONDE qui sont téléchargeables depuis l’url suivante. La logique suivie est celle d’une chaîne de traitements depuis le téléchargement des données brutes sur le web jusqu’à la visualisation cartographique. Il propose un ensemble de fonctions qui permettent de : - télécharger les fichiers bruts annuels - les décompresser - les assembler - pivoter le tableau en format “large” - compléter les données des stations par des données sur les SAGEs - calculer les statistiques d’assecs estivaux - visualiser graphiquement le “tableau de bord” de chacune des stations - exporter ces graphiques au format .bmp - visualiser les données en cartographie dynamique La chaîne de traitements étant dédiée aux données ONDE au format standardisé de leur diffusion, elle ne fonctionne que dans la mesure où l’utilisateur conserve les noms des variables. Le moindre renommage et plus rien ne marche !","code":""},{"path":"https://pascalirz.github.io/ondetools/articles/vignette_ondetools.html","id":"installation","dir":"Articles","previous_headings":"","what":"Installation","title":"Documentation du package ondetools","text":"Comme tout package R, {ondetools} doit d’abord être téléchargé, puis activé. Pour le télécharger, suivre les instructions de ce post de blog. L’activation du package se fait par la fonction library. Pour fonctionner, il fait appel à d’autres packages qui sont aussi installés par défaut quand installe {ondetools}. D’autres packages sont nécessaires, non pas au fonctionnement de {ondetools}, mais pour exécuter le présent tutoriel : Présentation des tableaux html : DT Cartographie : mapview et sf Mise en forme des données : tidyverse et lubridate Téléchargement : Installation : Chaque fonction est accompagnée d’un fichier d’aide. Exemple :","code":"remotes::install_github(\"PascalIrz/ondetools\") library(ondetools) install.packages(c(\"lubridate\", \"mapview\", \"sf\", \"dplyr\", \"stringr\", \"ggplot2\")) library(lubridate) library(mapview) library(sf)  library(dplyr) library(stringr) library(ggplot2) ?calculer_assecs_ete()"},{"path":[]},{"path":"https://pascalirz.github.io/ondetools/articles/vignette_ondetools.html","id":"téléchargement-et-stockage-des-fichiers","dir":"Articles","previous_headings":"Chargement et mise en forme des données tabulées","what":"Téléchargement et stockage des fichiers","title":"Documentation du package ondetools","text":"Le stockage par défaut de ces fichiers est dans un sous-répertoire du répertoire de travail “raw_data/fichiers_onde_annuels_zippes”. Vérification que les fichiers annuels zippés sont dans le bon répertoire","code":"url_onde <- paste0(\"https://onde.eaufrance.fr/content/\",                    \"t%C3%A9l%C3%A9charger-les-donn%C3%A9es-des-campagnes-par-ann%C3%A9e\") telecharger_fichiers_onde_annuels(url = url_onde, raw_data_dir = 'raw_data') list.files(\"raw_data/fichiers_onde_annuels_zippes\") #>  [1] \"metadonnees.pdf\"      \"onde_france_2012.csv\" \"onde_france_2012.zip\" #>  [4] \"onde_france_2013.csv\" \"onde_france_2013.zip\" \"onde_france_2014.csv\" #>  [7] \"onde_france_2014.zip\" \"onde_france_2015.csv\" \"onde_france_2015.zip\" #> [10] \"onde_france_2016.csv\" \"onde_france_2016.zip\" \"onde_france_2017.csv\" #> [13] \"onde_france_2017.zip\" \"onde_france_2018.csv\" \"onde_france_2018.zip\" #> [16] \"onde_france_2019.csv\" \"onde_france_2019.zip\" \"onde_france_2020.csv\" #> [19] \"onde_france_2020.zip\" \"onde_france_2021.csv\" \"onde_france_2021.zip\" #> [22] \"onde_france_2022.csv\" \"onde_france_2022.zip\" \"onde_france_2023.csv\" #> [25] \"onde_france_2023.zip\" \"onde_france_2024.csv\" \"onde_france_2024.zip\""},{"path":"https://pascalirz.github.io/ondetools/articles/vignette_ondetools.html","id":"assemblage-des-fichiers-annuels","dir":"Articles","previous_headings":"Chargement et mise en forme des données tabulées","what":"Assemblage des fichiers annuels","title":"Documentation du package ondetools","text":"Il s’agit d’empiler les fichiers annuels. Si l’souhaite supprimer le répertoire contenant les fichiers téléchargés :","code":"onde <- assembler_fichiers_onde_annuels_csv(annual_onde_files_dir = \"raw_data/fichiers_onde_annuels_zippes\") unlink(\"raw_data/fichiers_onde_annuels_zippes\", recursive = TRUE)"},{"path":"https://pascalirz.github.io/ondetools/articles/vignette_ondetools.html","id":"vérification-que-tout-sest-bien-passé","dir":"Articles","previous_headings":"Chargement et mise en forme des données tabulées","what":"Vérification que tout s’est bien passé","title":"Documentation du package ondetools","text":"Les dimensions du tableau de données ou data.frame : Il y donc 277362 lignes et 20 colonnes. Les caractéristiques des variables peuvent être obtenues par la fonction str() :","code":"dim(onde) #> [1] 277362     20 str(onde) #> Classes 'data.table' and 'data.frame':   277362 obs. of  20 variables: #>  $ CdSiteHydro            : chr  \"G2100611\" \"G1100001\" \"G0100001\" \"G7100611\" ... #>  $ LbSiteHydro            : chr  \"Varenne à St Martin\" \"Yères à Aubermesnil\" \"Bresles à Criquiers\" \"La Ganzeville à Bec\" ... #>  $ Annee                  : int  2012 2012 2012 2012 2012 2012 2012 2012 2012 2012 ... #>  $ TypeCampObservations   : chr  \"complémentaire\" \"complémentaire\" \"complémentaire\" \"complémentaire\" ... #>  $ DtRealObservation      : chr  \"2012-05-23\" \"2012-05-23\" \"2012-05-23\" \"2012-05-22\" ... #>  $ LbRsObservationDpt     : chr  \"Ecoulement non visible\" \"Ecoulement visible acceptable\" \"Ecoulement visible acceptable\" \"Ecoulement visible acceptable\" ... #>  $ RsObservationDpt       : chr  \"2\" \"1a\" \"1a\" \"1a\" ... #>  $ LbRsObservationNat     : chr  \"Ecoulement non visible\" \"Ecoulement visible\" \"Ecoulement visible\" \"Ecoulement visible\" ... #>  $ RsObservationNat       : int  2 1 1 1 1 1 1 2 1 1 ... #>  $ NomEntiteHydrographique: chr  \"\" \"L'Yeres\" \"La Bresle\" \"Ruisseau de Ganzeville\" ... #>  $ CdTronconHydrographique: chr  \"\" \"G11-0400\" \"G01-0400\" \"G7100600\" ... #>  $ LbCommune              : chr  \"SAINT-MARTIN-OSMONVILLE\" \"AUBERMESNIL-AUX-ERABLES\" \"CRIQUIERS\" \"BEC-DE-MORTAGNE\" ... #>  $ CdCommune              : chr  \"76621\" \"76029\" \"76199\" \"76068\" ... #>  $ CdDepartement          : chr  \"76\" \"76\" \"76\" \"76\" ... #>  $ LbRegion               : chr  \"NORMANDIE\" \"NORMANDIE\" \"NORMANDIE\" \"NORMANDIE\" ... #>  $ NomCircAdminBassin     : chr  \"Seine-Normandie\" \"Seine-Normandie\" \"Seine-Normandie\" \"Seine-Normandie\" ... #>  $ CoordXSiteHydro        : num  578434 596802 609737 516353 600224 ... #>  $ CoordYSiteHydro        : num  6949971 6970529 6955406 6958763 6950564 ... #>  $ ProjCoordSiteHydro     : int  2154 2154 2154 2154 2154 2154 2154 2154 2154 2154 ... #>  $ FLG                    : chr  \"FLG\" \"FLG\" \"FLG\" \"FLG\" ... #>  - attr(*, \".internal.selfref\")=<externalptr>"},{"path":"https://pascalirz.github.io/ondetools/articles/vignette_ondetools.html","id":"création-de-la-variable-mois","dir":"Articles","previous_headings":"Chargement et mise en forme des données tabulées","what":"Création de la variable Mois","title":"Documentation du package ondetools","text":"Une variable Mois est créée à partir de la date d’observation. Pour un usage graphique ultérieur, elle est en format texte à 2 caractères.","code":"onde <- mutate(onde, Mois = lubridate::ymd(DtRealObservation),                Mois = lubridate::month(Mois),                Mois = str_pad(Mois, width = 2, side = \"left\", pad = \"0\")) %>%   filter(TRUE)"},{"path":"https://pascalirz.github.io/ondetools/articles/vignette_ondetools.html","id":"filtrage-sur-le-périmètre-géographique","dir":"Articles","previous_headings":"Chargement et mise en forme des données tabulées","what":"Filtrage sur le périmètre géographique","title":"Documentation du package ondetools","text":"Il existe plusieurs variables correspondants aux départements, régions, districts hydrographiques qui permettent de filtrer simplement. Ici, nous nous intéressons aux régions Bretagne et Pays-de-la-Loire.","code":"onde <- onde %>%   filter(CdDepartement %in% c(\"29\", \"22\", \"35\", \"56\", \"85\", \"44\", \"49\", \"53\", \"72\"))"},{"path":"https://pascalirz.github.io/ondetools/articles/vignette_ondetools.html","id":"gestion-des-campagnes","dir":"Articles","previous_headings":"Chargement et mise en forme des données tabulées","what":"Gestion des campagnes","title":"Documentation du package ondetools","text":"La fonction gerer_les_campagnes filtre les données pour ne conserver qu’une observation par mois. De mai à septembre inclus, c’est l’observation de la campagne “usuelle” qui est retenue. D’octobre à avril, c’est la plus sèche des observations “complémentaires”.","code":"onde <- gerer_les_campagnes(onde_df = onde)"},{"path":"https://pascalirz.github.io/ondetools/articles/vignette_ondetools.html","id":"passage-en-format-large","dir":"Articles","previous_headings":"Chargement et mise en forme des données tabulées","what":"Passage en format “large”","title":"Documentation du package ondetools","text":"Pour certains usages comme la visualisation des observations d’un mois donné (ex : juillet 2018) avec QGIS, il peut être intéressant de disposer des mêmes données, mais avec une colonne par année_mois. La fonction passer_en_format_large() permet cette manipulation en pivotant les cellules à la manière d’un tableau croisé dynamique dans Excel®.","code":"onde_lb_large <- passer_en_format_large(onde_df_long = onde)"},{"path":"https://pascalirz.github.io/ondetools/articles/vignette_ondetools.html","id":"exportation-en-format-csv","dir":"Articles","previous_headings":"Chargement et mise en forme des données tabulées","what":"Exportation en format CSV","title":"Documentation du package ondetools","text":"peut à ce stade exporter les tableaux de données en format texte directement lisible par Excel® dans un répertoire “processed_data”.","code":"dir.create(file.path(subDir = 'processed_data'), showWarnings = FALSE) write_excel_csv2(x = onde, path = 'processed_data/onde_long.csv') write_excel_csv2(x = onde_lb_large, path = 'processed_data/onde_large.csv')"},{"path":"https://pascalirz.github.io/ondetools/articles/vignette_ondetools.html","id":"création-de-la-couche-géographique-des-stations","dir":"Articles","previous_headings":"","what":"Création de la couche géographique des stations","title":"Documentation du package ondetools","text":"Il s’agit de transformer le tableau de données au format “long” en objet géographique “points” au moyen de ses colonnes de coordonnées (CoordXSiteHydro et CoordYSiteHydro). Le système de projection est Lambert 93. Vérification","code":"stations_onde_geo <- creer_couche_geo_stations(onde_df = onde) ggplot(data = stations_onde_geo) + geom_sf()"},{"path":"https://pascalirz.github.io/ondetools/articles/vignette_ondetools.html","id":"caractérisation-des-assecs-estivaux","dir":"Articles","previous_headings":"","what":"Caractérisation des assecs estivaux","title":"Documentation du package ondetools","text":"Pour visualiser la fréquence des assecs sur le périmètre étudié, il est nécessaire d’agréger les données par station. Comme les efforts de collecte de données sont standardisés pour les campagnes “usuelles” (une observation par mois), tandis que les campagnes complémentaires varient fortement d’un département à un autre, seules les premières sont retenues.","code":""},{"path":"https://pascalirz.github.io/ondetools/articles/vignette_ondetools.html","id":"calcul","dir":"Articles","previous_headings":"Caractérisation des assecs estivaux","what":"Calcul","title":"Documentation du package ondetools","text":"La fonction calculer_assecs_ete() retourne un dataframe donnant pour chaque station (ligne) le nombre d’observations, le nombre d’assecs et le pourcentage des observations où la station était en assec. complète la couche géographique des stations avec ces données. Si nécessaire, peut reprojeter en WGS84 (crs 4326) - le système utilisé par OpenStreetMap ou GoogleMaps.","code":"assecs <- calculer_assecs_ete(onde_df = onde) stations_onde_geo <- ajouter_donnees_assecs_aux_stations(stations_geo = stations_onde_geo,                                                          assecs_df = assecs) #> Joining with `by = join_by(CdSiteHydro)` stations_onde_geo <- st_transform(stations_onde_geo, crs = 4326)"},{"path":"https://pascalirz.github.io/ondetools/articles/vignette_ondetools.html","id":"vérification-visuelle","dir":"Articles","previous_headings":"Caractérisation des assecs estivaux","what":"Vérification visuelle","title":"Documentation du package ondetools","text":"Si l’veut vérifier la cohérence des étapes précédentes, peut visualiser les objets.","code":"mapview(stations_onde_geo, cex = \"taille_point\",         layer.name = \"Assecs\", label = \"Station ONDE\",         col.regions = \"red\")"},{"path":[]},{"path":"https://pascalirz.github.io/ondetools/articles/vignette_ondetools.html","id":"définition-de-la-légende-et-de-ses-codes-couleur","dir":"Articles","previous_headings":"Production des graphiques par station","what":"Définition de la légende et de ses codes couleur","title":"Documentation du package ondetools","text":"définit une palette de couleurs pour s’assurer qu’une même situation soit systématiquement représentée par une même couleur dans les graphiques. Le \\n est le retour à la ligne pour que les étiquettes ne prennent pas trop de place sur le graphique Pour les besoins de la représentation graphique, complète le fichier avec des NA (données manquantes) pour les mois sans observations. La fonction completer_observations_mois_manquants() est alors utile.","code":"mes_couleurs <- c(\"Ecoulement\\nvisible\" = \"blue\",           \"Ecoulement\\nnon visible\" = \"brown\",           \"Assec\" = \"red\",           \"Observation\\nimpossible\" = \"grey\",           \"NA\" = \"grey\") codes_stations <- unique(pull(stations_onde_geo, CdSiteHydro))  onde_ts_mois <- completer_observations_mois_manquants(onde_df = onde,                                                       stations = codes_stations)"},{"path":"https://pascalirz.github.io/ondetools/articles/vignette_ondetools.html","id":"essai-de-la-fonction-graphique","dir":"Articles","previous_headings":"Production des graphiques par station","what":"Essai de la fonction graphique","title":"Documentation du package ondetools","text":"","code":"ma_station <- pull(onde, CdSiteHydro) ma_station <- ma_station[3689]  produire_graph_pour_une_station(code_station = ma_station, onde_df = onde_ts_mois, couleurs = mes_couleurs)"},{"path":"https://pascalirz.github.io/ondetools/articles/vignette_ondetools.html","id":"liste-contenant-tous-les-graphiques","dir":"Articles","previous_headings":"Production des graphiques par station","what":"Liste contenant tous les graphiques","title":"Documentation du package ondetools","text":"Le logiciel R permet la manipulation de nombreuses classes d’objets parmi lesquelles trouve les listes. Une liste est un ensemble d’éléments qui peuvent être de nature différente. Ici, nous allons créer une liste qui contiendra autant d’objets graphiques qu’il y de stations. La fonction produire_graph_pour_toutes_les_stations() est une “moulinette” qui permet d’appliquer la fonction de production du graphique (produire_graph_pour_une_station()) non pas à une station, mais à un ensemble. Cette liste servira soit pour afficher les graphiques sous la forme de popups dans mapview, soit pour les exporter 1 à 1 en .png pour d’autres usages. Pour vérifier que la liste bien été créée, peut afficher certains de ses éléments, par exemple les 10ème à 12ème.","code":"graphiques <- produire_graph_pour_toutes_les_stations(stations = codes_stations,                                                       fonction_graphique = produire_graph_pour_une_station,                                                       onde_df = onde_ts_mois,                                                       couleurs = mes_couleurs) graphiques[10:12] #> [[1]] #>  #> [[2]] #>  #> [[3]]"},{"path":"https://pascalirz.github.io/ondetools/articles/vignette_ondetools.html","id":"exportation-des-graphiques-en--png","dir":"Articles","previous_headings":"Production des graphiques par station","what":"Exportation des graphiques en .png","title":"Documentation du package ondetools","text":"La fonction exporter_les_graphiques_png exporte chacun des graphiques de la liste au format png, le nomme selon les codes stations. Ils sont stockés dans le répertoire fourni par l’utilisateur. Si le répertoire n’existe pas, la fonction le crée. Sinon, elle écrase son contenu antérieur. Au final, il y un fichier par station. L’exécution de la fonction prend environ une seconde par station.","code":"exporter_les_graphiques_png(stations_geo = stations_onde_geo,                             liste_graphiques = graphiques,                             repertoire = 'processed_data/graphiques')"},{"path":"https://pascalirz.github.io/ondetools/articles/vignette_ondetools.html","id":"représentation-cartographique","dir":"Articles","previous_headings":"","what":"Représentation cartographique","title":"Documentation du package ondetools","text":"peut afficher nos résultats dans une fenêtre leaflet au moyen du package mapview avec les popup graphiques. NB : L’affichage initial prend un peu de temps, variable selon la taille de la région représentée. C’est dû d’une part au chargement des données géographiques et d’autre part au chargement des popups graphiques.","code":"mapviewOptions(basemaps = c(\"OpenStreetMap\", \"OpenTopoMap\",                              \"Esri.WorldShadedRelief\", \"Esri.WorldImagery\"))   produire_carte_dynamique (couche_stations = stations_onde_geo,                           popups_stations = graphiques)"},{"path":"https://pascalirz.github.io/ondetools/articles/vignette_rapports.html","id":"rapport-départemental-mensuel-avec-le-package-ondetools","dir":"Articles","previous_headings":"","what":"Rapport départemental mensuel avec le package ondetools","title":"Rapports mensuels ONDE","text":"Les données ONDE sont mises à jour mensuellement et un rapport mensuel peut facilement être édité à l’échelle d’un département, dont le contenu regroupe un ensemble d’informations.","code":""},{"path":"https://pascalirz.github.io/ondetools/articles/vignette_rapports.html","id":"contenu-du-rapport","dir":"Articles","previous_headings":"Rapport départemental mensuel avec le package ondetools","what":"Contenu du rapport","title":"Rapports mensuels ONDE","text":"Le rapport est un document au format Microsoft Office Word avec la charte graphique de l’établissement.  Dans le rapport, retrouve : un rappel sur le réseau ONDE (informations générales, protocoles, …) ; le nombre de stations dans le département et les dernières campagnes réalisées ; la situation mensuelle départementale pour le mois en cours selon deux typologies (nationale et départementale) ; l’historicité sur le département (variations de l’indice ONDE, des types d’écoulement, fréquence des assecs, …) ; le détail stations par stations regroupées par zones d’alerte Propluvia. .","code":""},{"path":"https://pascalirz.github.io/ondetools/articles/vignette_rapports.html","id":"procédure-pour-créer-undes-rapports-mensuels","dir":"Articles","previous_headings":"Rapport départemental mensuel avec le package ondetools","what":"Procédure pour créer un(des) rapport(s) mensuel(s)","title":"Rapports mensuels ONDE","text":"Pour cela, il faut télécharger au préalable les données ONDE avec la fonction telecharger_donnees_onde_api() sur un ou plusieurs départements. Dans l’exemple ci-dessous, les départements du 14, 27 et 60 sont choisis. Ensuite, il faut définir plusieurs paramètres qui seront utilisés pour la création du rapport : les données onde à utiliser (avec l’argument onde_df) ; les départements souhaités (avec l’argument code_departement) ; le mois et l’année du rapport voulu (avec l’argument annee_mois, par exemple 2023-06 pour un rapport avec les données du mois de juin 2023) (⚠ le format est important) ; le nom de la DR qui doit figurer sur le(s) rapport(s) (avec l’argument region_dr) ; si le rapport voulu concerne un rapport pour une campagne complémentaire ou non (avec l’argument complementaire) ; et le dossier de sortie où le(s) rapport(s) sera(seront) créé(s) (avec l’argument dossier_sortie).","code":"## 1) Charger le package library(ondetools)  ## 2) Choisir ses départements mes_dpts <- c('14', '27', '60')  ## 3) Télécharger les données onde onde_df <- telecharger_donnees_onde_api(dpt = mes_dpts) ## 4) Produire le(s) rapport(s)  produire_rapport_mensuel_dpt(   onde_df = onde_df,   code_departement = mes_dpts,   annee_mois = \"2023-06\",   region_dr = 'Normandie',   complementaire = F,   dossier_sortie = \"./OUTPUT\" )"},{"path":"https://pascalirz.github.io/ondetools/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Pascal Irz. Maintainer.","code":""},{"path":"https://pascalirz.github.io/ondetools/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Irz, P. (2023). ondetools: Package R pour traiter les données ONDE de suivi des étiages en France. R package version 0.1.2, URL: https://github.com/PascalIrz/ondetools","code":"@Manual{,   title = {ondetools: Package R pour traiter les données ONDE de suivi des étiages en France},   author = {P. Irz},   year = {2023},   volume = {R package version 0.1.2},   url = {https://github.com/PascalIrz/ondetools}, }"},{"path":"https://pascalirz.github.io/ondetools/index.html","id":"ondetools","dir":"","previous_headings":"","what":"Package R pour traiter les données ONDE de suivi des étiages en France","title":"Package R pour traiter les données ONDE de suivi des étiages en France","text":"Le package {ondetools} vise à faciliter le chargement et l’exploitation des données de l’observatoire national des étiages - ONDE. Ces données sont mises à disposition en ligne. Elles couvrent la France métropolitaine depuis 2012. package proposes set functions easier processing ONDE monitoring data intermittent streams mainland France. allows streamlining workflow downloading annual data files, tidying displaying results interactive map. data collection started 2012. La logique suivie est celle d’une chaîne de traitements depuis le téléchargement des données brutes sur le web jusqu’à la visualisation cartographique. Il propose un ensemble de fonctions qui permettent de : télécharger les fichiers bruts annuels les décompresser les assembler pivoter le tableau en format “large” compléter les données des stations par des données sur les SAGEs calculer les statistiques d’assecs estivaux visualiser graphiquement le “tableau de bord” de chacune des stations exporter ces graphiques au format .bmp visualiser les données en cartographie dynamique","code":""},{"path":"https://pascalirz.github.io/ondetools/index.html","id":"documentation","dir":"","previous_headings":"","what":"Documentation","title":"Package R pour traiter les données ONDE de suivi des étiages en France","text":"Chaque fonction est accompagnée d’une aide. Une documentation donne une vue d’ensemble de la chaîne de traitements “type”.","code":""},{"path":"https://pascalirz.github.io/ondetools/index.html","id":"attention","dir":"","previous_headings":"","what":"ATTENTION","title":"Package R pour traiter les données ONDE de suivi des étiages en France","text":"La version 2.9.0 du package {mapview} sur le dépôt CRAN contient un bug. Si vous n’arrivez pas à afficher la carte interactive, désinstallez {mapview} puis réinstallez-la version de développement depuis Github avec : remotes::install_github(\"r-spatial/mapview\").","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/ajouter_donnees_assecs_aux_stations.html","id":null,"dir":"Reference","previous_headings":"","what":"Ajout des données d'assecs aux stations — ajouter_donnees_assecs_aux_stations","title":"Ajout des données d'assecs aux stations — ajouter_donnees_assecs_aux_stations","text":"Cette fonction permet d'ajouter à l'objet géographique (classe `sf` points) des stations les attributs     caractérisant les assecs. #'     La correspondance se fait par une jointure sur les codes des     stations CdSiteHydro.","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/ajouter_donnees_assecs_aux_stations.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Ajout des données d'assecs aux stations — ajouter_donnees_assecs_aux_stations","text":"","code":"ajouter_donnees_assecs_aux_stations(stations_geo, assecs_df)"},{"path":"https://pascalirz.github.io/ondetools/reference/ajouter_donnees_assecs_aux_stations.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Ajout des données d'assecs aux stations — ajouter_donnees_assecs_aux_stations","text":"stations_geo L'objet géographique points des stations assecs_df Le dataframe contenant les données d'assecs","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/ajouter_donnees_assecs_aux_stations.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Ajout des données d'assecs aux stations — ajouter_donnees_assecs_aux_stations","text":"La fonction renvoit l'objet géographique points des stations auquel ont été ajoutées les données     d'assecs.","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/ajouter_donnees_assecs_aux_stations.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Ajout des données d'assecs aux stations — ajouter_donnees_assecs_aux_stations","text":"","code":"if (FALSE) { stations_onde_geo <- stations_onde_geo %>%     ajouter_donnees_assecs_aux_stations(assecs_df = assecs) }"},{"path":"https://pascalirz.github.io/ondetools/reference/ajouter_zones_propluvia.html","id":null,"dir":"Reference","previous_headings":"","what":"Ajouter les données de zones d'alerte Propluvia au tableau de données onde — ajouter_zones_propluvia","title":"Ajouter les données de zones d'alerte Propluvia au tableau de données onde — ajouter_zones_propluvia","text":"Ajouter les données de zones d'alerte Propluvia au tableau de données onde","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/ajouter_zones_propluvia.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Ajouter les données de zones d'alerte Propluvia au tableau de données onde — ajouter_zones_propluvia","text":"","code":"ajouter_zones_propluvia(onde_df, propluvia_shape)"},{"path":"https://pascalirz.github.io/ondetools/reference/ajouter_zones_propluvia.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Ajouter les données de zones d'alerte Propluvia au tableau de données onde — ajouter_zones_propluvia","text":"onde_df un tableau de données onde téléchargé avec la fonction telecharger_donnees_onde_api propluvia_shape la couche spatiale pour les zones d'alerte Propluvia. Une version existe en tant que jeux de données dans le package : (propluvia_zone).","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/ajouter_zones_propluvia.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Ajouter les données de zones d'alerte Propluvia au tableau de données onde — ajouter_zones_propluvia","text":"un dataframe comprenant les données onde et les données Propluvia jointées spatialement.","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/ajouter_zones_propluvia.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Ajouter les données de zones d'alerte Propluvia au tableau de données onde — ajouter_zones_propluvia","text":"","code":"if (FALSE) { ajouter_zones_propluvia(onde_df = onde_14, propluvia_shape = propluvia_zone) }"},{"path":"https://pascalirz.github.io/ondetools/reference/assembler_fichiers_onde_annuels_csv.html","id":null,"dir":"Reference","previous_headings":"","what":"Assemblage des fichiers annuels — assembler_fichiers_onde_annuels_csv","title":"Assemblage des fichiers annuels — assembler_fichiers_onde_annuels_csv","text":"Cette fonction permet d'assembler - en les empilant - les fichiers csv issus de la fonction     telecharger_fichiers_onde_annuels() en un unique dataframe. La sortie est le dataframe national     pour l'ensemble des années où la donnée est disponible.","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/assembler_fichiers_onde_annuels_csv.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Assemblage des fichiers annuels — assembler_fichiers_onde_annuels_csv","text":"","code":"assembler_fichiers_onde_annuels_csv(annual_onde_files_dir)"},{"path":"https://pascalirz.github.io/ondetools/reference/assembler_fichiers_onde_annuels_csv.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Assemblage des fichiers annuels — assembler_fichiers_onde_annuels_csv","text":"annual_onde_files_dir Chaîne de caractères indiquant le chemin vers le répertoire où se trouvent les fichiers annuels","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/assembler_fichiers_onde_annuels_csv.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Assemblage des fichiers annuels — assembler_fichiers_onde_annuels_csv","text":"Dataframe national pour l'ensemble des années de données disponibles","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/assembler_fichiers_onde_annuels_csv.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Assemblage des fichiers annuels — assembler_fichiers_onde_annuels_csv","text":"","code":"if (FALSE) { onde <- assembler_fichiers_onde_annuels_csv( annual_onde_files_dir = \"raw_data/fichiers_onde_annuels_zippes\" ) }"},{"path":"https://pascalirz.github.io/ondetools/reference/calculer_assecs_ete.html","id":null,"dir":"Reference","previous_headings":"","what":"Caractérisation des assecs — calculer_assecs_ete","title":"Caractérisation des assecs — calculer_assecs_ete","text":"Caractérisation de la fréquence des assecs. Comme le recours à des campagnes dites \"complémentaires\" varie largement     selon les régions et départements, pour que la caractérisation ait un sens, elle est restreinte     aux observations des mois d'été, donc des données des campagnes \"usuelles\".","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/calculer_assecs_ete.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Caractérisation des assecs — calculer_assecs_ete","text":"","code":"calculer_assecs_ete(onde_df)"},{"path":"https://pascalirz.github.io/ondetools/reference/calculer_assecs_ete.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Caractérisation des assecs — calculer_assecs_ete","text":"onde_df Le dataframe contenant les données ONDE en format long.","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/calculer_assecs_ete.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Caractérisation des assecs — calculer_assecs_ete","text":"Un dataframe donnant pour chaque station (ligne) le nombre d'observations, le nombre d'assecs     et le pourcentage des observations où la station était en assec.","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/calculer_assecs_ete.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Caractérisation des assecs — calculer_assecs_ete","text":"","code":"if (FALSE) { assecs <- calculer_assecs_ete(onde_df = onde) }"},{"path":"https://pascalirz.github.io/ondetools/reference/calculer_assecs_heatmap.html","id":null,"dir":"Reference","previous_headings":"","what":"Fonction pour calculer les pourcentages de stations en assec — calculer_assecs_heatmap","title":"Fonction pour calculer les pourcentages de stations en assec — calculer_assecs_heatmap","text":"Calcule les pourcentages de stations en assec (sur les mois de campagnes usuelles)  et met en forme du tableau pour le graphique de type heatmap","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/calculer_assecs_heatmap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fonction pour calculer les pourcentages de stations en assec — calculer_assecs_heatmap","text":"","code":"calculer_assecs_heatmap(onde_df)"},{"path":"https://pascalirz.github.io/ondetools/reference/calculer_assecs_heatmap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fonction pour calculer les pourcentages de stations en assec — calculer_assecs_heatmap","text":"onde_df un tableau de données onde téléchargé avec la fonction telecharger_donnees_onde_api","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/calculer_assecs_heatmap.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fonction pour calculer les pourcentages de stations en assec — calculer_assecs_heatmap","text":"un tableau résumant au format pour le graphique avec la  fonction produire_graph_heatmap_assecs","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/calculer_assecs_heatmap.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fonction pour calculer les pourcentages de stations en assec — calculer_assecs_heatmap","text":"","code":"if (FALSE) { onde_14 <- telecharger_donnees_onde_api(dpt = c('14')) calculer_assecs_heatmap(onde_df = onde_14) }"},{"path":"https://pascalirz.github.io/ondetools/reference/calculer_bilan_ecoulement.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculer un bilan des types d'écoulement pour les campagnes ONDE usuelles selon\n la typologie nationale ou départementale — calculer_bilan_ecoulement","title":"Calculer un bilan des types d'écoulement pour les campagnes ONDE usuelles selon\n la typologie nationale ou départementale — calculer_bilan_ecoulement","text":"Calculer un bilan des types d'écoulement pour les campagnes ONDE usuelles selon  la typologie nationale ou départementale","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/calculer_bilan_ecoulement.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculer un bilan des types d'écoulement pour les campagnes ONDE usuelles selon\n la typologie nationale ou départementale — calculer_bilan_ecoulement","text":"","code":"calculer_bilan_ecoulement(   onde_df,   referentiel_onde = \"Typologie nationale\",   mod,   mod_levels,   force_complementaire = F,   ... )"},{"path":"https://pascalirz.github.io/ondetools/reference/calculer_bilan_ecoulement.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculer un bilan des types d'écoulement pour les campagnes ONDE usuelles selon\n la typologie nationale ou départementale — calculer_bilan_ecoulement","text":"onde_df un tableau de données onde téléchargé avec la fonction telecharger_donnees_onde_api referentiel_onde le nom de la typologie à utiliser, soit Typologie nationale ou Typologie départementale mod Le nom pour la colonne créée pour la typologie. Par exemple, soit lib_ecoul3mod pour la typologie nationale ou lib_ecoul4mod pour la typologie départementale, mod_levels les niveaux de facteurs souhaités en fonction des typologies. force_complementaire booléen, si TRUE les complémentaires sont prises en compte dans le calcul. Par défaut, FALSE. ... paramètre optionnel","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/calculer_bilan_ecoulement.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculer un bilan des types d'écoulement pour les campagnes ONDE usuelles selon\n la typologie nationale ou départementale — calculer_bilan_ecoulement","text":"un dataframe avec les pourcentages par types d’écoulement selon la typologie choisie","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/calculer_bilan_ecoulement.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculer un bilan des types d'écoulement pour les campagnes ONDE usuelles selon\n la typologie nationale ou départementale — calculer_bilan_ecoulement","text":"","code":"if (FALSE) { ## bilan écoulement sur typologie nationale sur les usuelles uniquement calculer_bilan_ecoulement(onde_df = onde_df,                         mod = lib_ecoul,                         mod_levels = c(\"Ecoulement visible\",                                        \"Ecoulement non visible\",                                        \"Assec\",                                        \"Observation impossible\",                                        \"Donnée manquante\"),                         referentiel_onde = \"Typologie nationale\",                         force_complementaire = F)  ## bilan écoulement sur typologie départementale avec les complémentaires calculer_bilan_ecoulement(onde_df = onde_df,                           mod = lib_ecoul,                           mod_levels = c(\"Ecoulement visible acceptable\",                                          \"Ecoulement visible faible\",                                          \"Ecoulement non visible\",                                          \"Assec\",                                          \"Observation impossible\",                                          \"Donnée manquante\"),                           referentiel_onde = \"Typologie départementale\",                           force_complementaire = F)  ## bilan écoulement sur typologie nationale avec les complémentaires calculer_bilan_ecoulement(onde_df = onde_df,                         mod = lib_ecoul,                         mod_levels = c(\"Ecoulement visible\",                                        \"Ecoulement non visible\",                                        \"Assec\",                                        \"Observation impossible\",                                        \"Donnée manquante\"),                         referentiel_onde = \"Typologie nationale\",                         force_complementaire = T)  }"},{"path":"https://pascalirz.github.io/ondetools/reference/calculer_indice_onde.html","id":null,"dir":"Reference","previous_headings":"","what":"Fonction pour calculer les indices ONDE sur les campagnes usuelles — calculer_indice_onde","title":"Fonction pour calculer les indices ONDE sur les campagnes usuelles — calculer_indice_onde","text":"La fonction permet de calculer les indices ONDE départementaux à partir des campagnes  usuelles d'un tableau. L'indice est une note variant de 1 à 10, en prenant en compte  les nombres de stations avec écoulements interrompus et écoulements continus.","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/calculer_indice_onde.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fonction pour calculer les indices ONDE sur les campagnes usuelles — calculer_indice_onde","text":"","code":"calculer_indice_onde(onde_df = NULL, force_complementaire = F)"},{"path":"https://pascalirz.github.io/ondetools/reference/calculer_indice_onde.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fonction pour calculer les indices ONDE sur les campagnes usuelles — calculer_indice_onde","text":"onde_df un tableau de données onde téléchargé avec la fonction telecharger_donnees_onde_api force_complementaire argument booléen. Si TRUE, force le calcul des indices sur toutes les campagnes (usuelles et complémentaires avec un minimum de 25 observations par campagne). Par défaut, égal à FALSE","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/calculer_indice_onde.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fonction pour calculer les indices ONDE sur les campagnes usuelles — calculer_indice_onde","text":"retourne un tableau avec une colonne 'indice'","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/calculer_indice_onde.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fonction pour calculer les indices ONDE sur les campagnes usuelles — calculer_indice_onde","text":"","code":"if (FALSE) { calculer_indice_onde(onde_df = onde) }"},{"path":"https://pascalirz.github.io/ondetools/reference/calculer_recurrence_assecs.html","id":null,"dir":"Reference","previous_headings":"","what":"Fonction pour calculer la récurrence des assecs consécutifs sur les stations — calculer_recurrence_assecs","title":"Fonction pour calculer la récurrence des assecs consécutifs sur les stations — calculer_recurrence_assecs","text":"Fonction pour calculer la récurrence des assecs consécutifs sur les stations","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/calculer_recurrence_assecs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fonction pour calculer la récurrence des assecs consécutifs sur les stations — calculer_recurrence_assecs","text":"","code":"calculer_recurrence_assecs(onde_df)"},{"path":"https://pascalirz.github.io/ondetools/reference/calculer_recurrence_assecs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fonction pour calculer la récurrence des assecs consécutifs sur les stations — calculer_recurrence_assecs","text":"onde_df un tableau de données onde téléchargé avec la fonction telecharger_donnees_onde_api","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/calculer_recurrence_assecs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fonction pour calculer la récurrence des assecs consécutifs sur les stations — calculer_recurrence_assecs","text":"un tableau de synthèse avec le nombre de stations (et pourcentage) par durée  d'assecs (de 1 à 5 mois consécutifs) sur la période de campagne usuelle (mai à septembre)","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/calculer_recurrence_assecs.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fonction pour calculer la récurrence des assecs consécutifs sur les stations — calculer_recurrence_assecs","text":"","code":"if (FALSE) { onde_14 <- telecharger_donnees_onde_api(dpt = c('14')) calculer_recurrence_assecs(onde_df = onde_14) }"},{"path":"https://pascalirz.github.io/ondetools/reference/completer_observations_mois_manquants.html","id":null,"dir":"Reference","previous_headings":"","what":"Ajout des mois sans observations — completer_observations_mois_manquants","title":"Ajout des mois sans observations — completer_observations_mois_manquants","text":"Afin de permettre une représentation graphique de l'ensemble de la période de collecte des données     d'étiage, cette fonction ajoute à un tableau de données ONDE, qui ne comprend que des données     d'observations, tous les mois pour lesquels il n'y pas eu d'observations. Le tableau de sortie     comprend donc un nombre de lignes qui est le produit de nombre de stations par le nombre     d'années d'observations par 12 mois : 12 x nb_années x nb_stations.","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/completer_observations_mois_manquants.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Ajout des mois sans observations — completer_observations_mois_manquants","text":"","code":"completer_observations_mois_manquants(onde_df, stations)"},{"path":"https://pascalirz.github.io/ondetools/reference/completer_observations_mois_manquants.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Ajout des mois sans observations — completer_observations_mois_manquants","text":"onde_df Le dataframe contenant les données ONDE en format \"long\". stations Le vecteur (caractère) des identifiants des stations au sens du champ \"CdSiteHydro\" de la base ONDE.","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/completer_observations_mois_manquants.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Ajout des mois sans observations — completer_observations_mois_manquants","text":"Le dataframe contenant les données ONDE en format \"long\" complété avec les mois sans données pour lesquels     l'observation est notée NA.","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/completer_observations_mois_manquants.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Ajout des mois sans observations — completer_observations_mois_manquants","text":"","code":"if (FALSE) { onde_ts_mois <- completer_observations_mois_manquants(onde_df = onde, stations = codes_stations)}"},{"path":"https://pascalirz.github.io/ondetools/reference/coursdeau_carthage_classe1a4.html","id":null,"dir":"Reference","previous_headings":"","what":"Cours d'eau BD Carthage 1 à 4 — coursdeau_carthage_classe1a4","title":"Cours d'eau BD Carthage 1 à 4 — coursdeau_carthage_classe1a4","text":"Un tableau contenant les informations géographiques (multilignes) pour les  cours d'eau de rangs 1 à 4 issus de la BD Carthage.","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/coursdeau_carthage_classe1a4.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Cours d'eau BD Carthage 1 à 4 — coursdeau_carthage_classe1a4","text":"","code":"coursdeau_carthage_classe1a4"},{"path":"https://pascalirz.github.io/ondetools/reference/coursdeau_carthage_classe1a4.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Cours d'eau BD Carthage 1 à 4 — coursdeau_carthage_classe1a4","text":"un dataframe au  format sf (multilignes - crs RGF93) CdEntiteHy code de référence du cours d'eau NomEntiteH nom du cours d'eau Classe rang du cours d'eau de 1 à 4 geometry la géométrie du cours d'eau","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/creer_couche_geo_stations.html","id":null,"dir":"Reference","previous_headings":"","what":"Créer la couche géographique des stations — creer_couche_geo_stations","title":"Créer la couche géographique des stations — creer_couche_geo_stations","text":"Cette fonction crée un objet géographique de classe `sf` à partir du fichier ONDE au format \"long\" et de     ses colonnes de coordonnées (\"CoordXSiteHydro\", \"CoordYSiteHydro\"). Le système de projection est     Lambert 93.","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/creer_couche_geo_stations.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Créer la couche géographique des stations — creer_couche_geo_stations","text":"","code":"creer_couche_geo_stations(onde_df)"},{"path":"https://pascalirz.github.io/ondetools/reference/creer_couche_geo_stations.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Créer la couche géographique des stations — creer_couche_geo_stations","text":"onde_df Le dataframe contenant les données ONDE. NB les colonnes ne doivent pas avoir été renommées.","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/creer_couche_geo_stations.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Créer la couche géographique des stations — creer_couche_geo_stations","text":"La sortie est l'objet géographique de classe `sf` constitué des points correspondant à chacune des stations.     Il comprend autant de lignes qu'il y de stations.","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/creer_couche_geo_stations.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Créer la couche géographique des stations — creer_couche_geo_stations","text":"","code":"if (FALSE) { stations_onde_geo <- creer_couche_geo_stations(onde_df = onde)}"},{"path":"https://pascalirz.github.io/ondetools/reference/creer_variable_Mois.html","id":null,"dir":"Reference","previous_headings":"","what":"Création de la variable Mois — creer_variable_Mois","title":"Création de la variable Mois — creer_variable_Mois","text":"Création de la variable Mois en 2 caractères alphanumériques (01 à 12). Ce format est plus pratique pour les     graphiques ultérieurs qui nécessitent une variable catégorielle mais ordonnée.","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/creer_variable_Mois.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Création de la variable Mois — creer_variable_Mois","text":"","code":"creer_variable_Mois(onde_df)"},{"path":"https://pascalirz.github.io/ondetools/reference/creer_variable_Mois.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Création de la variable Mois — creer_variable_Mois","text":"onde_df Le dataframe contenant les données ONDE, mis en forme en format \"long\".","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/creer_variable_Mois.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Création de la variable Mois — creer_variable_Mois","text":"Le dataframe contenant les données ONDE, mis en forme en format \"long\", auquel été ajoutée     une variable caractère \"Mois\" codée de \"01\" à \"12\".","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/creer_variable_Mois.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Création de la variable Mois — creer_variable_Mois","text":"","code":"if (FALSE) { stations_onde_geo <- stations_onde_geo %>%     creer_variable_Mois() }"},{"path":"https://pascalirz.github.io/ondetools/reference/exporter_les_graphiques_png.html","id":null,"dir":"Reference","previous_headings":"","what":"Export des graphiques en format png — exporter_les_graphiques_png","title":"Export des graphiques en format png — exporter_les_graphiques_png","text":"Cette fonction exporte chacun des graphiques au format png, le nomme selon les codes SAGEs et station +     les intitulés des SAGEs. Ils sont stockés dans le répertoire fourni par l'utilisateur. Si le répertoire     n'existe pas, la fonction le crée. Sinon, elle écrase son contenu antérieur. Au final, il y un fichier     par station. L'exécution de la fonction prend environ une seconde par station.","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/exporter_les_graphiques_png.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Export des graphiques en format png — exporter_les_graphiques_png","text":"","code":"exporter_les_graphiques_png(stations_geo, liste_graphiques, repertoire)"},{"path":"https://pascalirz.github.io/ondetools/reference/exporter_les_graphiques_png.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Export des graphiques en format png — exporter_les_graphiques_png","text":"stations_geo La couche géographique des stations (classe `sf`), contenant la variable \"CdSiteHydro\". du fichier ONDE. liste_graphiques La liste contenant les graphiques, qui aura été auparavant produite par la fonction produire_graph_pour_toutes_les_stations(). repertoire Chaîne de caractère indiquant le chemin vers le répertoire de stockage des fichiers png.","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/exporter_les_graphiques_png.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Export des graphiques en format png — exporter_les_graphiques_png","text":"La fonction produit autant de fichiers png qu'il y de stations.","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/exporter_les_graphiques_png.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Export des graphiques en format png — exporter_les_graphiques_png","text":"","code":"if (FALSE) { exporter_les_graphiques_png(stations_geo = stations_onde_geo, liste_graphiques = graphiques, repertoire = 'processed_data/graphiques') }"},{"path":"https://pascalirz.github.io/ondetools/reference/gerer_les_campagnes.html","id":null,"dir":"Reference","previous_headings":"","what":"Gestion des campagnes d'observation de terrain — gerer_les_campagnes","title":"Gestion des campagnes d'observation de terrain — gerer_les_campagnes","text":"Avec cette fonction, les données sont filtrées pour ne conserver qu'une observation     par mois. De mai à septembre inclus, c'est l'observation de la campagne     \"usuelle\" qui est retenue. D'octobre à avril, c'est la plus sèche des observations     \"complémentaires\".","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/gerer_les_campagnes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Gestion des campagnes d'observation de terrain — gerer_les_campagnes","text":"","code":"gerer_les_campagnes(onde_df)"},{"path":"https://pascalirz.github.io/ondetools/reference/gerer_les_campagnes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Gestion des campagnes d'observation de terrain — gerer_les_campagnes","text":"onde_df Le dataframe contenant les données ONDE mis en forme par la fonction assembler_fichiers_onde_annuels_csv().","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/gerer_les_campagnes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Gestion des campagnes d'observation de terrain — gerer_les_campagnes","text":"Le dataframe avec une donnée par mois après application de règles concernant les campagnes     usuelles et complémentaires.","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/gerer_les_campagnes.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Gestion des campagnes d'observation de terrain — gerer_les_campagnes","text":"","code":"if (FALSE) { onde <- gerer_les_campagnes(onde_df = onde)}"},{"path":"https://pascalirz.github.io/ondetools/reference/lire_couche_sages.html","id":null,"dir":"Reference","previous_headings":"","what":"Lecture de la couche des SAGEs — lire_couche_sages","title":"Lecture de la couche des SAGEs — lire_couche_sages","text":"Cette fonction permet d'importer dans R le fichier shapefile polygones des SAGEs.     Par défaut, le système de coordonnées (SCR) est le Lambert 93 (EPSG:2154).","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/lire_couche_sages.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Lecture de la couche des SAGEs — lire_couche_sages","text":"","code":"lire_couche_sages(fichier_shp, scr = 2154)"},{"path":"https://pascalirz.github.io/ondetools/reference/lire_couche_sages.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Lecture de la couche des SAGEs — lire_couche_sages","text":"fichier_shp Chaîne de caractères indiquant le chemin vers le fichier shapefile des SAGEs. Il peut être absolu ou relatif. scr Numérique entier indiquant le Système de Coordonnées de Référence par son code EPSG. titre d'exemples le code du Lambert II étendu est 27572 et celui dui WGS84 est 4326.","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/lire_couche_sages.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Lecture de la couche des SAGEs — lire_couche_sages","text":"La fonction retourne un objet de classe géographique sf comprenant les polygones correspondant     aux périmètres des SAGEs.","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/lire_couche_sages.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Lecture de la couche des SAGEs — lire_couche_sages","text":"","code":"if (FALSE) { sages <- lire_couche_sages(fichier_shp = couche_sage, scr = 2154)}"},{"path":"https://pascalirz.github.io/ondetools/reference/onde_4mod.html","id":null,"dir":"Reference","previous_headings":"","what":"Couleurs pour modalités ONDE - typologie 4 modalités — onde_4mod","title":"Couleurs pour modalités ONDE - typologie 4 modalités — onde_4mod","text":"Un vecteur pour les 4 modalités d'observations du protocole ONDE.","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/onde_4mod.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Couleurs pour modalités ONDE - typologie 4 modalités — onde_4mod","text":"","code":"onde_4mod"},{"path":"https://pascalirz.github.io/ondetools/reference/onde_4mod.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Couleurs pour modalités ONDE - typologie 4 modalités — onde_4mod","text":"un vecteur de couleurs","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/onde_5mod.html","id":null,"dir":"Reference","previous_headings":"","what":"Couleurs pour modalités ONDE - typologie 5 modalités — onde_5mod","title":"Couleurs pour modalités ONDE - typologie 5 modalités — onde_5mod","text":"Un vecteur pour les 5 modalités d'observations du protocole ONDE.","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/onde_5mod.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Couleurs pour modalités ONDE - typologie 5 modalités — onde_5mod","text":"","code":"onde_5mod"},{"path":"https://pascalirz.github.io/ondetools/reference/onde_5mod.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Couleurs pour modalités ONDE - typologie 5 modalités — onde_5mod","text":"un vecteur de couleurs","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/passer_en_format_large.html","id":null,"dir":"Reference","previous_headings":"","what":"Passage du tableau de données en format large — passer_en_format_large","title":"Passage du tableau de données en format large — passer_en_format_large","text":"Cette fonction \"pivote\" le tableau ONDE produit par la fonction assembler_fichiers_onde_annuels_csv(),     qui est en format \"long\" , pour le mettre en format \"large\", avec une colonne par combinaison     annee_mois.","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/passer_en_format_large.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Passage du tableau de données en format large — passer_en_format_large","text":"","code":"passer_en_format_large(onde_df_long)"},{"path":"https://pascalirz.github.io/ondetools/reference/passer_en_format_large.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Passage du tableau de données en format large — passer_en_format_large","text":"onde_df_long dataframe en format long issu de la fonction gerer_les_campagnes()","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/passer_en_format_large.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Passage du tableau de données en format large — passer_en_format_large","text":"le dataframe en format large (une colonne par annee_mois)","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/passer_en_format_large.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Passage du tableau de données en format large — passer_en_format_large","text":"","code":"if (FALSE) { onde_lb_large <- passer_en_format_large(onde_df_long = onde) }"},{"path":"https://pascalirz.github.io/ondetools/reference/produire_carte_dynamique.html","id":null,"dir":"Reference","previous_headings":"","what":"Produire la carte dynamique — produire_carte_dynamique","title":"Produire la carte dynamique — produire_carte_dynamique","text":"Fonction permattant de produire la carte dynamique des stations avec des symboles ronds proportionnels au pourcentage     des observations où la station est en assec avec une sous-couche des SAGE. Plusieurs fonds de cartes sont proposés.","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/produire_carte_dynamique.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Produire la carte dynamique — produire_carte_dynamique","text":"","code":"produire_carte_dynamique(couche_stations, popups_stations, couche_sages = NA)"},{"path":"https://pascalirz.github.io/ondetools/reference/produire_carte_dynamique.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Produire la carte dynamique — produire_carte_dynamique","text":"couche_stations Couche_stations (objet R de classe sf) qui été prétraitée pour comporter un champ \"pourcentage_assecs\". popups_stations Liste comprenant autant d'éléments (graphiques) qu'il y de stations représentées. Cette liste est produite par la fonction produire_graph_pour_toutes_les_stations(). couche_sages Paramètre facultatif. Couche des SAGEs (objet R de classe sf) qui doit comporter un champ \"NOM\".","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/produire_carte_dynamique.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Produire la carte dynamique — produire_carte_dynamique","text":"La fonction retourne la carte dynamique qui s'ouvre dans le navigateur web.","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/produire_carte_dynamique.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Produire la carte dynamique — produire_carte_dynamique","text":"","code":"if (FALSE) { produire_carte_dynamique (couche_sages = sages, couche_stations = stations_onde_geo, popups_stations = graphiques) }"},{"path":"https://pascalirz.github.io/ondetools/reference/produire_carte_statique.html","id":null,"dir":"Reference","previous_headings":"","what":"Produire une carte départementale de la situation mensuelle des observations ONDE — produire_carte_statique","title":"Produire une carte départementale de la situation mensuelle des observations ONDE — produire_carte_statique","text":"Produire une carte départementale de la situation mensuelle des observations ONDE","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/produire_carte_statique.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Produire une carte départementale de la situation mensuelle des observations ONDE — produire_carte_statique","text":"","code":"produire_carte_statique(   onde_df_mois = NULL,   code_departement = NULL,   referentiel_onde = \"Typologie nationale\",   couleurs = onde_4mod,   dptFR_shp = NULL )"},{"path":"https://pascalirz.github.io/ondetools/reference/produire_carte_statique.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Produire une carte départementale de la situation mensuelle des observations ONDE — produire_carte_statique","text":"onde_df_mois tableau contenant les données ONDE pour le mois souhaité code_departement le code insee du département, par exemple '14' pour l'Eure referentiel_onde la typologie à utiliser, soit Typologie nationale ou Typologie départementale couleurs un vecteur de couleurs correspondant aux référentiels national ou départemental dptFR_shp une couche shape pour les départements FR","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/produire_carte_statique.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Produire une carte départementale de la situation mensuelle des observations ONDE — produire_carte_statique","text":"un graphique ggplot2","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/produire_carte_statique.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Produire une carte départementale de la situation mensuelle des observations ONDE — produire_carte_statique","text":"","code":"if (FALSE) { dptFR <-   COGiter::departements_geo %>%   dplyr::left_join(COGiter::departements %>%                      dplyr::select(DEP, REG, NOM_DEP))  produire_carte_statique(code_departement = '27',                          onde_df_mois = onde_df_mois2,                          referentiel_onde = 'Typologie départementale',                          couleurs = onde_5mod,                          dptFR_shp = dptFR)  produire_carte_statique(code_departement = '27',                          onde_df_mois = onde_df_mois2,                          referentiel_onde = 'Typologie nationale',                          couleurs = onde_4mod,                          dptFR_shp = dptFR) }"},{"path":"https://pascalirz.github.io/ondetools/reference/produire_graph_heatmap_assecs.html","id":null,"dir":"Reference","previous_headings":"","what":"Produire un graphique type heatmap pour les assecs des campagnes usuelles onde — produire_graph_heatmap_assecs","title":"Produire un graphique type heatmap pour les assecs des campagnes usuelles onde — produire_graph_heatmap_assecs","text":"Produire un graphique type heatmap pour les assecs des campagnes usuelles onde","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/produire_graph_heatmap_assecs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Produire un graphique type heatmap pour les assecs des campagnes usuelles onde — produire_graph_heatmap_assecs","text":"","code":"produire_graph_heatmap_assecs(heatmap_df, autoscale = F, rotate = F)"},{"path":"https://pascalirz.github.io/ondetools/reference/produire_graph_heatmap_assecs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Produire un graphique type heatmap pour les assecs des campagnes usuelles onde — produire_graph_heatmap_assecs","text":"heatmap_df un dataframe produit avec la fonction calculer_assecs_heatmap autoscale booléen, si TRUE l'échelle de couleurs est automatique pour les pourcentages. Par défaut, autoscale = FALSE (échelle de 0 à 100). rotate booléen, si TRUE les années sont représentées sur l'axe des ordonnées et les mois sur l'axe des abscisses. Par défaut, FALSE.","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/produire_graph_heatmap_assecs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Produire un graphique type heatmap pour les assecs des campagnes usuelles onde — produire_graph_heatmap_assecs","text":"un graphique ggplot2 type heatmap","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/produire_graph_heatmap_assecs.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Produire un graphique type heatmap pour les assecs des campagnes usuelles onde — produire_graph_heatmap_assecs","text":"","code":"if (FALSE) { onde_14 <- telecharger_donnees_onde_api(dpt = c('14'))  heatmap_14 <- calculer_assecs_heatmap(onde_df = onde_14)  produire_graph_heatmap_assecs(heatmap_df = heatmap_14, autoscale = T)  }"},{"path":"https://pascalirz.github.io/ondetools/reference/produire_graph_pour_toutes_les_stations.html","id":null,"dir":"Reference","previous_headings":"","what":"Produire les graphiques pour toutes les stations — produire_graph_pour_toutes_les_stations","title":"Produire les graphiques pour toutes les stations — produire_graph_pour_toutes_les_stations","text":"Cette fonction est une \"moulinette\" qui permet d'appliquer la fonction de production du graphique non pas à une     station, mais à un ensemble.","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/produire_graph_pour_toutes_les_stations.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Produire les graphiques pour toutes les stations — produire_graph_pour_toutes_les_stations","text":"","code":"produire_graph_pour_toutes_les_stations(   stations,   fonction_graphique,   onde_df_ts_mois,   couleurs )"},{"path":"https://pascalirz.github.io/ondetools/reference/produire_graph_pour_toutes_les_stations.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Produire les graphiques pour toutes les stations — produire_graph_pour_toutes_les_stations","text":"stations Le vecteur (caractère) des identifiants des stations au sens du champ \"CdSiteHydro\" de la base ONDE. fonction_graphique La fonction graphique à appliquer sur chacune des stations. Ici il s'agit de la fonction produire_graph_pour_toutes_les_stations(). onde_df_ts_mois Le dataframe des données ONDE qui été complété pour les mois où il n'y pas eu d'observations. Produit par le fonction completer_observations_mois_manquants(). couleurs Un vecteur nommé qui associe à chacune des modalités d'observation (ex : écoulement visible) une couleur.","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/produire_graph_pour_toutes_les_stations.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Produire les graphiques pour toutes les stations — produire_graph_pour_toutes_les_stations","text":"La fonction produit un objet de classe \"list\" qui contient autant de graphiques qu'il y de stations.","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/produire_graph_pour_toutes_les_stations.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Produire les graphiques pour toutes les stations — produire_graph_pour_toutes_les_stations","text":"","code":"if (FALSE) { graphiques <- produire_graph_pour_toutes_les_stations(stations = codes_stations, fonction_graphique = produire_graph_pour_une_station, onde_df = onde_ts_mois, couleurs = mes_couleurs) }"},{"path":"https://pascalirz.github.io/ondetools/reference/produire_graph_pour_une_station.html","id":null,"dir":"Reference","previous_headings":"","what":"Produire le graphique des assecs pour une station — produire_graph_pour_une_station","title":"Produire le graphique des assecs pour une station — produire_graph_pour_une_station","text":"Cette fonction permet de produire le graphique des assecs pour une station donnée sur l'ensemble des années     de la série.","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/produire_graph_pour_une_station.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Produire le graphique des assecs pour une station — produire_graph_pour_une_station","text":"","code":"produire_graph_pour_une_station(code_station, onde_df, couleurs)"},{"path":"https://pascalirz.github.io/ondetools/reference/produire_graph_pour_une_station.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Produire le graphique des assecs pour une station — produire_graph_pour_une_station","text":"code_station L'identifiant de la station ONDE (Variable CdSiteHydro). onde_df Le dataframe en format \"long\" qui contient les données ONDE. couleurs Un vecteur nommé qui associe à chacune des modalités d'observation (ex : écoulement visible) une couleur.","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/produire_graph_pour_une_station.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Produire le graphique des assecs pour une station — produire_graph_pour_une_station","text":"Le graphique obtenu par ggplot.","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/produire_graph_pour_une_station.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Produire le graphique des assecs pour une station — produire_graph_pour_une_station","text":"","code":"if (FALSE) { mes_couleurs <- c(\"Ecoulement\\nvisible\" = \"blue\", \"Ecoulement\\nnon visible\" = \"brown\", \"Assec\" = \"red\", \"Observation\\nimpossible\" = \"grey\", \"NA\" = \"grey\")  produire_graph_pour_une_station(code_station = \"J0014011\", onde_df = onde_ts_mois, couleurs = mes_couleurs) }"},{"path":"https://pascalirz.github.io/ondetools/reference/produire_graph_pour_une_station_v2.html","id":null,"dir":"Reference","previous_headings":"","what":"Produire graphique historique pour station (nouvelle version!) — produire_graph_pour_une_station_v2","title":"Produire graphique historique pour station (nouvelle version!) — produire_graph_pour_une_station_v2","text":"Nouvelle version de la fonction pour produire un graphique à la station de l'historique des écoulements. Celle-ci permet d'utiliser les données téléchargées issues de l'API et de pouvoir représenter, à la fois, les campagnes usuelles et complémentaires sur le même graphique. Il est également possible d'utiliser la typologie départementale.","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/produire_graph_pour_une_station_v2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Produire graphique historique pour station (nouvelle version!) — produire_graph_pour_une_station_v2","text":"","code":"produire_graph_pour_une_station_v2(   station_vec,   onde_df,   type_mod,   mod_levels,   mod_colors )"},{"path":"https://pascalirz.github.io/ondetools/reference/produire_graph_pour_une_station_v2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Produire graphique historique pour station (nouvelle version!) — produire_graph_pour_une_station_v2","text":"station_vec identifiant de la station à représenter graphiquement (colonne code_station) onde_df un tableau de données onde téléchargé avec la fonction telecharger_donnees_onde_api type_mod nom de colonne choisie définissant la variable écoulement mod_levels vecteur définissant les noms de modalités d'écoulement. Doit correspondre aux valeurs retrouvées dans la colonne type_mod mod_colors vecteur de couleur nommé qui associe à chacune des modalités d'observation une couleur.","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/produire_graph_pour_une_station_v2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Produire graphique historique pour station (nouvelle version!) — produire_graph_pour_une_station_v2","text":"un graphique ggplot2 pour l'historique des observations à la station  avec les différentes campagnes (usuelles et complémentaires)","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/produire_graph_pour_une_station_v2.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Produire graphique historique pour station (nouvelle version!) — produire_graph_pour_une_station_v2","text":"","code":"if (FALSE) { onde_14 <- telecharger_donnees_onde_api(dpt = c('14'))  onde_periode <-   onde_14 %>%   dplyr::mutate(     Annee = as.numeric(Annee),     Mois = format(as.Date(date_campagne), \"%m\"),     Mois_campagne = lubridate::ym(paste0(Annee,Mois,sep=\"-\"))   ) %>%   dplyr::mutate(     libelle_ecoulement = dplyr::case_when(       libelle_ecoulement == 'Ecoulement visible' ~ 'Ecoulement visible acceptable',       TRUE ~ libelle_ecoulement     )   )  produire_graph_pour_une_station_v2(station_vec = onde_periode$code_station[1],                                 type_mod = libelle_ecoulement,                                 onde_df = onde_periode,                                 mod_levels = c(\"Assec\",                                                \"Ecoulement\\nnon visible\",                                                \"Ecoulement\\nvisible\\nfaible\",                                                \"Ecoulement\\nvisible\\nacceptable\",                                                \"Observation\\nimpossible\",                                                \"Donnée\\nmanquante\"),                                 mod_colors = onde_5mod  ) }"},{"path":"https://pascalirz.github.io/ondetools/reference/produire_graph_reccurrence_assecs.html","id":null,"dir":"Reference","previous_headings":"","what":"Produire un graphique du nombre de stations réparties selon les durées en\n assecs consécutifs par années de suivis. — produire_graph_reccurrence_assecs","title":"Produire un graphique du nombre de stations réparties selon les durées en\n assecs consécutifs par années de suivis. — produire_graph_reccurrence_assecs","text":"La durée des assecs, en nombre de mois consécutifs, est calculée pour chaque station sur  la période des campagnes usuelles (de mai à septembre). Les campagnes complémentaires ne sont  pas utilisées.","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/produire_graph_reccurrence_assecs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Produire un graphique du nombre de stations réparties selon les durées en\n assecs consécutifs par années de suivis. — produire_graph_reccurrence_assecs","text":"","code":"produire_graph_reccurrence_assecs(df_assecs, round_prec = 1)"},{"path":"https://pascalirz.github.io/ondetools/reference/produire_graph_reccurrence_assecs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Produire un graphique du nombre de stations réparties selon les durées en\n assecs consécutifs par années de suivis. — produire_graph_reccurrence_assecs","text":"df_assecs un tableau résumé de la durée des assecs produit avec round_prec nombre de chiffres pour arrondir la valeur du pourcentage calculé","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/produire_graph_reccurrence_assecs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Produire un graphique du nombre de stations réparties selon les durées en\n assecs consécutifs par années de suivis. — produire_graph_reccurrence_assecs","text":"un graphique ggplot2","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/produire_graph_reccurrence_assecs.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Produire un graphique du nombre de stations réparties selon les durées en\n assecs consécutifs par années de suivis. — produire_graph_reccurrence_assecs","text":"","code":"if (FALSE) { onde_14 <- telecharger_donnees_onde_api(dpt = c('14'))  onde_14_recurrence <- calculer_recurrence_assecs(onde_df = onde_14)  produire_graph_reccurrence_assecs(df_assecs = onde_14_recurrence) }"},{"path":"https://pascalirz.github.io/ondetools/reference/produire_graph_type_ecoulement.html","id":null,"dir":"Reference","previous_headings":"","what":"Produire le graphique bilan des écoulements — produire_graph_type_ecoulement","title":"Produire le graphique bilan des écoulements — produire_graph_type_ecoulement","text":"Produire le graphique bilan des écoulements","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/produire_graph_type_ecoulement.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Produire le graphique bilan des écoulements — produire_graph_type_ecoulement","text":"","code":"produire_graph_type_ecoulement(data_bilan, lib_ecoulement, historique = FALSE)"},{"path":"https://pascalirz.github.io/ondetools/reference/produire_graph_type_ecoulement.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Produire le graphique bilan des écoulements — produire_graph_type_ecoulement","text":"data_bilan un dataframe comprenant les différents types d'écoulement observés. Peut être calculé avec la fonction calculer_bilan_ecoulement lib_ecoulement la colonne contenant la variable des types écoulement historique booléen. Si FALSE, représente le graphique pour la dernière année en cours (année maximum des données). Si TRUE, représente le graphique résumant l'historique pour toutes les années.","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/produire_graph_type_ecoulement.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Produire le graphique bilan des écoulements — produire_graph_type_ecoulement","text":"un graphique avec ggplot2","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/produire_graph_type_ecoulement.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Produire le graphique bilan des écoulements — produire_graph_type_ecoulement","text":"","code":"if (FALSE) { # Exemple bilan typologie départementale campagnes usuelles pour le 27 data_bilan_ecoulement <-   calculer_bilan_ecoulement(onde_df = onde_df,                             mod = lib_ecoul,                             mod_levels = c(\"Ecoulement visible acceptable\",                                            \"Ecoulement visible faible\",                                            \"Ecoulement non visible\",                                            \"Assec\",                                            \"Observation impossible\",                                            \"Donnée manquante\"),                             referentiel_onde = \"Typologie départementale\",                             force_complementaire = F) %>%   dplyr::filter(code_departement == 27)  ## graph bilan de l'année en cours produire_graph_type_ecoulement(data_bilan = data_bilan_ecoulement,                                lib_ecoulement = lib_ecoul,                                historique = F)  ## graph bilan de toutes les années produire_graph_type_ecoulement(data_bilan = data_bilan_ecoulement,                                lib_ecoulement = lib_ecoul,                                historique = T)  # Exemple bilan typologie nationale TOUTES campagnes pour le 27 data_bilan_ecoulement <-   calculer_bilan_ecoulement(onde_df = onde_df,                             mod = lib_ecoul,                             mod_levels = c(\"Ecoulement visible\",                                            \"Ecoulement non visible\",                                            \"Assec\",                                            \"Observation impossible\",                                            \"Donnée manquante\"),                             referentiel_onde = \"Typologie nationale\",                             force_complementaire = T) %>%   dplyr::filter(code_departement == 27)  produire_graph_type_ecoulement(data_bilan = data_bilan_ecoulement,                                lib_ecoulement = lib_ecoul,                                historique = F)   }"},{"path":"https://pascalirz.github.io/ondetools/reference/produire_rapport_mensuel_dpt.html","id":null,"dir":"Reference","previous_headings":"","what":"Fonction pour produire un rapport mensuel départemental ONDE — produire_rapport_mensuel_dpt","title":"Fonction pour produire un rapport mensuel départemental ONDE — produire_rapport_mensuel_dpt","text":"Fonction pour produire un rapport mensuel départemental ONDE","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/produire_rapport_mensuel_dpt.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fonction pour produire un rapport mensuel départemental ONDE — produire_rapport_mensuel_dpt","text":"","code":"produire_rapport_mensuel_dpt(   onde_df,   code_departement,   annee_mois,   region_dr,   complementaire = FALSE,   dossier_sortie = getwd() )"},{"path":"https://pascalirz.github.io/ondetools/reference/produire_rapport_mensuel_dpt.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fonction pour produire un rapport mensuel départemental ONDE — produire_rapport_mensuel_dpt","text":"onde_df tableau contenant les données ONDE code_departement un seul code (insee) de département (ex: '27') ou une liste de départements pour plusieurs rapports (ex: c('14', '27', '76')) annee_mois l'année et le mois du(des) rapport(s) region_dr le nom de la DR qui sera affichée sur la page de garde du rapport complementaire booléen, si TRUE génère un rapport pour une campagne complémentaire. par défaut FALSE. dossier_sortie le dossier de sortie où le rapport sera stocké. Par défaut, le dossier de travail getwd()","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/produire_rapport_mensuel_dpt.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fonction pour produire un rapport mensuel départemental ONDE — produire_rapport_mensuel_dpt","text":"Renvoie un rapport mensuel au format Word pour les données du réseau ONDE  pour le département le mois et l'année spécifié","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/produire_rapport_mensuel_dpt.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fonction pour produire un rapport mensuel départemental ONDE — produire_rapport_mensuel_dpt","text":"","code":"## Un rapport pour le département 02 pour le mois de mai 2022 ('2022_05') if (FALSE) { produire_rapport_mensuel_dpt(onde_df = donnees_onde,                              code_departement = '02',                              annee_mois = \"2022_05\",                              region_dr = 'Hauts-de-France',                              complementaire = F,                              dossier_sortie = \"./OUTPUT\")  ## Rapports pour plusieurs départements (ex: 14, 27, 76) pour des complémentaires ##  du mois de juin 2023 ('2023_06')  produire_rapport_mensuel_dpt(onde_df = donnees_onde,                              code_departement = c('14', '27', '76'),                              annee_mois = \"2022_06\",                              region_dr = 'Normandie',                              complementaire = T,                              dossier_sortie = \"./OUTPUT\") }"},{"path":"https://pascalirz.github.io/ondetools/reference/propluvia_zone.html","id":null,"dir":"Reference","previous_headings":"","what":"Zones Propluvia — propluvia_zone","title":"Zones Propluvia — propluvia_zone","text":"Un tableau contenant les informations géographiques (multipolygones) pour les  zones d'arrêtés.","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/propluvia_zone.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Zones Propluvia — propluvia_zone","text":"","code":"propluvia_zone"},{"path":"https://pascalirz.github.io/ondetools/reference/propluvia_zone.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Zones Propluvia — propluvia_zone","text":"un dataframe au  format sf (multilignes - crs RGF93) CdEntiteHy code de référence du cours d'eau NomEntiteH nom du cours d'eau Classe rang du cours d'eau de 1 à 4 geometry la géométrie du cours d'eau","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/telecharger_donnees_onde_api.html","id":null,"dir":"Reference","previous_headings":"","what":"Télécharger les données ONDE pour un ou plusieurs départements — telecharger_donnees_onde_api","title":"Télécharger les données ONDE pour un ou plusieurs départements — telecharger_donnees_onde_api","text":"Cette fonction permet de télécharger les données ONDE via l'API Ecoulement sur la plateforme  HubEau (https://hubeau.eaufrance.fr/page/api-ecoulement)  pour un ou plusieurs départements.","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/telecharger_donnees_onde_api.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Télécharger les données ONDE pour un ou plusieurs départements — telecharger_donnees_onde_api","text":"","code":"telecharger_donnees_onde_api(dpt = NULL)"},{"path":"https://pascalirz.github.io/ondetools/reference/telecharger_donnees_onde_api.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Télécharger les données ONDE pour un ou plusieurs départements — telecharger_donnees_onde_api","text":"dpt un vecteur comprenant le code insee du(des) département(s). ex: c('27')","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/telecharger_donnees_onde_api.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Télécharger les données ONDE pour un ou plusieurs départements — telecharger_donnees_onde_api","text":"un dataframe avec les données campagnes, observations et stations.","code":""},{"path":[]},{"path":"https://pascalirz.github.io/ondetools/reference/telecharger_donnees_onde_api.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Télécharger les données ONDE pour un ou plusieurs départements — telecharger_donnees_onde_api","text":"","code":"if (FALSE) {  ## pour un département  telecharger_donnees_onde_api(dpt= c('14'))  ## pour plusieurs départements  telecharger_donnees_onde_api(dpt= c('02', '60', '80')) }"},{"path":"https://pascalirz.github.io/ondetools/reference/telecharger_fichiers_onde_annuels.html","id":null,"dir":"Reference","previous_headings":"","what":"Télécharger les fichiers — telecharger_fichiers_onde_annuels","title":"Télécharger les fichiers — telecharger_fichiers_onde_annuels","text":"Cette fonction permet de télécharger les fichiers compressés mis à disposition sur le portail des données ONDE,     de les stocker dans un répertoire local et de les décompresser. Il sont nommés de façon à     indiquer l'année à laquelle chacun correspond. Les métadonnées (en pdf) sont stockées dans le     même répertoire.","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/telecharger_fichiers_onde_annuels.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Télécharger les fichiers — telecharger_fichiers_onde_annuels","text":"","code":"telecharger_fichiers_onde_annuels(url, raw_data_dir = \"raw_data\")"},{"path":"https://pascalirz.github.io/ondetools/reference/telecharger_fichiers_onde_annuels.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Télécharger les fichiers — telecharger_fichiers_onde_annuels","text":"url La chaîne de caractères indiquant l'url où se trouvent les fichiers annuels à télécharger. raw_data_dir La chaîne de caractère indiquant le chemin vers le répertoire où stocker les fichiers bruts compressés + décompressés.","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/telecharger_fichiers_onde_annuels.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Télécharger les fichiers — telecharger_fichiers_onde_annuels","text":"La fonction crée un répertoire local et y dépose les fichiers annuels compressés (extension .zip)     et décompressés (extension .csv).","code":""},{"path":"https://pascalirz.github.io/ondetools/reference/telecharger_fichiers_onde_annuels.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Télécharger les fichiers — telecharger_fichiers_onde_annuels","text":"","code":"if (FALSE) { url_onde <- paste0(\"https://onde.eaufrance.fr/content/\", \"t%C3%A9l%C3%A9charger-les-donn%C3%A9es-des-campagnes-par-ann%C3%A9e\")  telecharger_fichiers_onde_annuels(url = url_onde, raw_data_dir = 'raw_data') }"}]
